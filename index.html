<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulário Fiscal</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script> 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <img id="logopdf" src="imagens/THUB-preto.png" style="display:none;" />
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; color: #333; }
    .header { display:flex; justify-content:space-between; align-items:center; background:#000; color:#fff; padding:10px 20px; }
    .header img { height:150px; }
    .header nav a { color:#fff; margin:0 15px; text-decoration:none; }
    .header nav a:hover { text-decoration:underline; }
    h2 { text-align:center; margin:30px 0; }
    .container { background:#fff; padding:20px; border-radius:8px; box-shadow:0 4px 8px rgba(0,0,0,0.1); margin-top:30px; }
    .form-control { margin-top:5px; margin-bottom:15px; }
    .btn-primary { background:#000; border:none; }
    .footer { background:#000; color:#fff; text-align:center; padding:30px 0; margin-top:30px; }
    .tag { display:inline-block; background:#007bff; color:#fff; padding:2px 6px; margin:2px; border-radius:4px; font-size:0.9em; }
  </style>
</head>
<body>

  <div class="header">
    <img src="imagens/THUB-branco.png" alt="Logo T.HUB">
    <nav>
      <a href="#">Início</a>
      <a href="#">Simples Nacional</a>
      <a href="#">Lucro Real</a>
    </nav>
  </div>

  <div class="container">
    <h2>Formulário de Regime Tributário Simples Nacional</h2>
    <form id="formFiscal">

      <!-- Bloco padrão de Natureza de Operação (intra-estado) -->
      <div id="natureza_padrao">
        <div class="form-group">
          <label for="csosn">CSOSN:</label>
          <select id="csosn" name="csosn" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="101">101 - Tributada com permissão de crédito</option>
            <option value="102">102 - Tributada sem permissão de crédito</option>
            <option value="103">103 - Isenção do ICMS para faixa de receita bruta</option>
            <option value="201">201 - Tributada com permissão de crédito e ST</option>
            <option value="202">202 - Tributada sem permissão de crédito e ST</option>
            <option value="203">203 - Isenção ICMS faixa e ST</option>
            <option value="300">300 - Imune</option>
            <option value="400">400 - Não tributada</option>
            <option value="500">500 - ICMS cobrado anteriormente</option>
            <option value="900">900 - Outros</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cfop">CFOP:</label>
          <input type="text" id="cfop" name="cfop" class="form-control" required pattern="^\d{4}$" maxlength="4"/>
        </div>
        <div class="form-group">
          <label for="icms_difal">ICMS DIFAL para não contribuinte:</label>
          <select id="icms_difal" name="icms_difal" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="Não">Não</option>
            <option value="Sim">Sim</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cst_ipi">CST - IPI:</label>
          <select id="cst_ipi" name="cst_ipi" class="form-control" required>
            <option value="">Selecionar</option>
                    <option value="50">50 - Saída tributada</option>
                    <option value="51">51 - Saída tributada com alíquota zero</option>
                    <option value="52">52 - Saída isenta</option>
                    <option value="53">53 - Saída não-tributada</option>
                    <option value="54">54 - Saída imune</option>
                    <option value="55">55 - Saída com suspensão</option>
                    <option value="99">99 - Outras saídas</option>
                    <option value="NDI">Não destacar IPI</option>
          </select>
        </div>
        <div class="form-group">
          <label for="aliquota_ipi">Alíquota (%) - IPI:</label>
          <input type="number" id="aliquota_ipi" name="aliquota_ipi" class="form-control" max="100" step="0.01" required/>
        </div>
        <div class="form-group">
          <label for="cst_issqn">CST - ISSQN:</label>
          <select id="cst_issqn" name="cst_issqn" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="tributado">Tributado</option>
            <option value="isento">Isento</option>
            <option value="Outra Situação">Outra situação</option>
          </select>
        </div>
        <div class="form-group">
          <label for="aliquota_issqn">Alíquota (%) - ISSQN:</label>
          <input type="number" id="aliquota_issqn" name="aliquota_issqn" class="form-control" max="100" step="0.01" required/>
        </div>
        <div class="form-group">
          <label for="base_issqn">Base (%) - ISSQN:</label>
          <input type="number" id="base_issqn" name="base_issqn" class="form-control" max="100" step="0.01" required/>
        </div>
        <div class="form-group">
          <label for="descontar_iss">Descontar ISS:</label>
          <select id="descontar_iss" name="descontar_iss" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="Sim">Sim</option>
            <option value="Não">Não</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cst_pis">CST - PIS:</label>
          <select id="cst_pis" name="cst_pis" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
        <div class="form-group">
          <label for="base_pis">Base (%) - PIS:</label>
          <input type="number" id="base_pis" name="base_pis" class="form-control" max="100" step="0.01" required/>
        </div>
        <div class="form-group">
          <label for="cst_cofins">CST - COFINS:</label>
          <select id="cst_cofins" name="cst_cofins" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
        <div class="form-group">
          <label for="base_cofins">Base (%) - COFINS:</label>
          <input type="number" id="base_cofins" name="base_cofins" class="form-control" max="100" step="0.01" required/>
        </div>
        <div class="form-group">
          <label for="aliquota">Alíquota (%):</label>
          <input type="number" id="aliquota" name="aliquota" class="form-control" max="100" step="0.01" required/>
        </div>
      </div>

      <!-- Natureza fora do Estado trigger -->
      <div class="form-group">
        <label for="has_natureza_fora">Natureza de Operação diferente para Vendas para fora do Estado?</label>
        <select id="has_natureza_fora" class="form-control">
          <option value="">Selecionar</option>
          <option value="Sim">Sim</option>
          <option value="Não">Não</option>
        </select>
      </div>

      <!-- Exceções de NCM -->
      <div class="form-group">
        <label for="has_exceptions_ncm">Existem exceções de NCM´s?</label>
        <select id="has_exceptions_ncm" class="form-control">
          <option value="">Selecionar</option>
          <option value="Sim">Sim</option>
          <option value="Não">Não</option>
        </select>
      </div>
      <div class="form-group" id="ncm_exceptions_group" style="display:none;">
        <label for="ncm_exceptions">NCM’s exceções (8 dígitos cada, pressione Enter para adicionar como tag):</label>
        <input type="text" id="ncm_exceptions" name="ncm_exceptions" class="form-control"
               placeholder="ex: 12345678" maxlength="8"/>
        <div id="ncm_tags"></div>
      </div>
      <!-- bloco de Natureza para NCM’s exceções -->
      <div id="exceptions_block" style="display:none; border-top:1px solid #ccc; padding-top:20px; margin-top:20px;">
        <h4>Natureza de Operação para NCM’s Exceções</h4>
      
        <!-- CSOSN exc -->
        <div class="form-group">
          <label for="csosn_exc">CSOSN (exc):</label>
          <select id="csosn_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="101">101 - Tributada com permissão de crédito</option>
            <option value="102">102 - Tributada sem permissão de crédito</option>
            <option value="103">103 - Isenção do ICMS para faixa de receita bruta</option>
            <option value="201">201 - Tributada com permissão de crédito e ST</option>
            <option value="202">202 - Tributada sem permissão de crédito e ST</option>
            <option value="203">203 - Isenção ICMS faixa e ST</option>
            <option value="300">300 - Imune</option>
            <option value="400">400 - Não tributada</option>
            <option value="500">500 - ICMS cobrado anteriormente</option>
            <option value="900">900 - Outros</option>
          </select>
        </div>
      
        <!-- CFOP exc -->
        <div class="form-group">
          <label for="cfop_exc">CFOP (exc):</label>
          <input type="text" id="cfop_exc" class="form-control" pattern="^\d{4}$" maxlength="4" required/>
        </div>
      
        <!-- ICMS DIFAL exc -->
        <div class="form-group">
          <label for="icms_difal_exc">ICMS DIFAL (exc):</label>
          <select id="icms_difal_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="Não">Não</option>
            <option value="Sim">Sim</option>
          </select>
        </div>
      
        <!-- CST - IPI exc -->
        <div class="form-group">
          <label for="cst_ipi_exc">CST - IPI (exc):</label>
          <select id="cst_ipi_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="50">50 - Saída tributada</option>
            <option value="51">51 - Saída tributada com alíquota zero</option>
            <option value="52">52 - Saída isenta</option>
            <option value="53">53 - Saída não-tributada</option>
            <option value="54">54 - Saída imune</option>
            <option value="55">55 - Saída com suspensão</option>
            <option value="99">99 - Outras saídas</option>
            <option value="NDI">Não destacar IPI</option>
          </select>
        </div>
      
        <div class="form-group">
          <label for="aliquota_ipi_exc">Alíquota (%) - IPI (exc):</label>
          <input type="number" id="aliquota_ipi_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      
        <!-- CST - ISSQN exc -->
        <div class="form-group">
          <label for="cst_issqn_exc">CST - ISSQN (exc):</label>
          <select id="cst_issqn_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="tributado">Tributado</option>
            <option value="isento">Isento</option>
            <option value="Outra Situação">Outra situação</option>
          </select>
        </div>
      
        <div class="form-group">
          <label for="aliquota_issqn_exc">Alíquota (%) - ISSQN (exc):</label>
          <input type="number" id="aliquota_issqn_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      
        <div class="form-group">
          <label for="base_issqn_exc">Base (%) - ISSQN (exc):</label>
          <input type="number" id="base_issqn_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      
        <div class="form-group">
          <label for="descontar_iss_exc">Descontar ISS (exc):</label>
          <select id="descontar_iss_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="Sim">Sim</option>
            <option value="Não">Não</option>
          </select>
        </div>
      
        <!-- PIS exc -->
        <div class="form-group">
          <label for="cst_pis_exc">CST - PIS (exc):</label>
          <select id="cst_pis_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
      
        <div class="form-group">
          <label for="base_pis_exc">Base (%) - PIS (exc):</label>
          <input type="number" id="base_pis_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      
        <!-- COFINS exc -->
        <div class="form-group">
          <label for="cst_cofins_exc">CST - COFINS (exc):</label>
          <select id="cst_cofins_exc" class="form-control" required>
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
      
        <div class="form-group">
          <label for="base_cofins_exc">Base (%) - COFINS (exc):</label>
          <input type="number" id="base_cofins_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      
        <div class="form-group">
          <label for="aliquota_exc">Alíquota (%) (exc):</label>
          <input type="number" id="aliquota_exc" class="form-control" max="100" step="0.01" required/>
        </div>
      </div>


      <!-- Bloco fora do Estado -->
      <div id="natureza_fora" style="display:none; border-top:1px solid #ccc; padding-top:20px; margin-top:20px;">
        <h4>Configurações para Vendas fora do Estado</h4>
        <!-- duplicado com sufixo _fora -->
        <div class="form-group">
          <label for="csosn_fora">CSOSN (fora):</label>
          <select id="csosn_fora" name="csosn_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="101">101 - Tributada com permissão de crédito</option>
            <option value="102">102 - Tributada sem permissão de crédito</option>
            <option value="103">103 - Isenção do ICMS para faixa de receita bruta</option>
            <option value="201">201 - Tributada com permissão de crédito e ST</option>
            <option value="202">202 - Tributada sem permissão de crédito e ST</option>
            <option value="203">203 - Isenção ICMS faixa e ST</option>
            <option value="300">300 - Imune</option>
            <option value="400">400 - Não tributada</option>
            <option value="500">500 - ICMS cobrado anteriormente</option>
            <option value="900">900 - Outros</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cfop_fora">CFOP (fora):</label>
          <input type="text" id="cfop_fora" name="cfop_fora" class="form-control" pattern="^\d{4}$" maxlength="4"/>
        </div>
        <div class="form-group">
          <label for="icms_difal_fora">ICMS DIFAL (fora):</label>
          <select id="icms_difal_fora" name="icms_difal_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="Não">Não</option>
            <option value="Sim">Sim</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cst_ipi_fora">CST - IPI (fora):</label>
          <select id="cst_ipi_fora" name="cst_ipi_fora" class="form-control">
            <option value="">Selecionar</option>
                    <option value="50">50 - Saída tributada</option>
                    <option value="51">51 - Saída tributada com alíquota zero</option>
                    <option value="52">52 - Saída isenta</option>
                    <option value="53">53 - Saída não-tributada</option>
                    <option value="54">54 - Saída imune</option>
                    <option value="55">55 - Saída com suspensão</option>
                    <option value="99">99 - Outras saídas</option>
                    <option value="NDI">Não destacar IPI</option>
          </select>
        </div>
        <div class="form-group">
          <label for="aliquota_ipi_fora">Alíquota (%) - IPI (fora):</label>
          <input type="number" id="aliquota_ipi_fora" name="aliquota_ipi_fora" class="form-control" max="100" step="0.01"/>
        </div>
        <div class="form-group">
          <label for="cst_issqn_fora">CST - ISSQN (fora):</label>
          <select id="cst_issqn_fora" name="cst_issqn_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="tributado">Tributado</option>
            <option value="isento">Isento</option>
            <option value="Outra Situação">Outra situação</option>
          </select>
        </div>
        <div class="form-group">
          <label for="aliquota_issqn_fora">Alíquota (%) - ISSQN (fora):</label>
          <input type="number" id="aliquota_issqn_fora" name="aliquota_issqn_fora" class="form-control" max="100" step="0.01"/>
        </div>
        <div class="form-group">
          <label for="base_issqn_fora">Base (%) - ISSQN (fora):</label>
          <input type="number" id="base_issqn_fora" name="base_issqn_fora" class="form-control" max="100" step="0.01"/>
        </div>
        <div class="form-group">
          <label for="descontar_iss_fora">Descontar ISS (fora):</label>
          <select id="descontar_iss_fora" name="descontar_iss_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="Sim">Sim</option>
            <option value="Não">Não</option>
          </select>
        </div>
        <div class="form-group">
          <label for="cst_pis_fora">CST - PIS (fora):</label>
          <select id="cst_pis_fora" name="cst_pis_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
        <div class="form-group">
          <label for="base_pis_fora">Base (%) - PIS (fora):</label>
          <input type="number" id="base_pis_fora" name="base_pis_fora" class="form-control" max="100" step="0.01"/>
        </div>
        <div class="form-group">
          <label for="cst_cofins_fora">CST - COFINS (fora):</label>
          <select id="cst_cofins_fora" name="cst_cofins_fora" class="form-control">
            <option value="">Selecionar</option>
            <option value="01">01 - Operação tributável (alíquota normal, cumulativo ou não)</option>
                    <option value="02">02 - Operação tributável (alíquota diferenciada)</option>
                    <option value="03">03 - Operação tributável (alíquota por unidade de produto)</option>
                    <option value="04">04 - Operação tributável (tributação monofásica, alíquota zero)</option>
                    <option value="05">05 - Operação Tributável (Substituição Tributária)</option>
                    <option value="06">06 - Operação tributável (alíquota zero)</option>
                    <option value="07">07 - Operação isenta da contribuição</option>
                    <option value="08">08 - Operação sem incidência da contribuição</option>
                    <option value="09">09 - Operação com suspensão da contribuição</option>
                    <option value="49">49 - Outras Operações de Saída</option>
                    <option value="50">50 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="51">51 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita Não Tributada no Mercado Interno</option>
                    <option value="52">52 - Operação com Direito a Crédito - Vinculada Exclusivamente a Receita de Exportação</option>
                    <option value="53">53 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno</option>
                    <option value="54">54 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="55">55 - Operação com Direito a Crédito - Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="56">56 - Operação com Direito a Crédito - Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="60">60 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Tributada no Mercado Interno</option>
                    <option value="61">61 - Crédito Presumido - Operação de Aquisição Vinculada Exclusivamente a Receita Não-Tributada no Mercado Interno</option>
                    <option value="62">62 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas no Mercado Interno e de Exportação</option>
                    <option value="63">63 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="64">64 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno, e de Exportação</option>
                    <option value="65">65 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="66">66 - Crédito Presumido - Operação de Aquisição Vinculada a Receitas Tributadas e Não-Tributadas no Mercado Interno e de Exportação</option>
                    <option value="67">67 - Crédito Presumido - Outras Operações</option>
                    <option value="70">70 - Operação de Aquisição sem Direito a Crédito</option>
                    <option value="71">71 - Operação de Aquisição com Isenção</option>
                    <option value="72">72 - Operação de Aquisição com Suspensão</option>
                    <option value="73">73 - Operação de Aquisição a Alíquota Zero</option>
                    <option value="74">74 - Operação de Aquisição sem Incidência da Contribuição</option>
                    <option value="75">75 - Operação de Aquisição por Substituição Tributária</option>
                    <option value="98">98 - Outras Operações de Entrada</option>
                    <option value="99">99 - Outras operações</option>
          </select>
        </div>
        <div class="form-group">
          <label for="base_cofins_fora">Base (%) - COFINS (fora):</label>
          <input type="number" id="base_cofins_fora" name="base_cofins_fora" class="form-control" max="100" step="0.01"/>
        </div>
        <div class="form-group">
          <label for="aliquota_fora">Alíquota (%) (fora):</label>
          <input type="number" id="aliquota_fora" name="aliquota_fora" class="form-control" max="100" step="0.01"/>
        </div>
      </div>

      <div class="form-group text-center">
        <button type="submit" class="btn btn-primary">Gerar PDFs</button>
      </div>
    </form>
  </div>

  <script>
    document.getElementById('has_exceptions_ncm').addEventListener('change', function(){
  document.getElementById('ncm_exceptions_group').style.display =
    this.value === 'Sim' ? 'block' : 'none';
  document.getElementById('exceptions_block').style.display =
    this.value === 'Sim' ? 'block' : 'none';
  if (this.value !== 'Sim') document.getElementById('ncm_tags').innerHTML = '';
});

document.getElementById('ncm_exceptions').addEventListener('keypress', function(e){
  if (e.key === 'Enter') {
    e.preventDefault();
    const val = this.value.trim();
    if (/^\d{8}$/.test(val)) {
      const span = document.createElement('span');
      span.className = 'tag';
      span.textContent = val;
      document.getElementById('ncm_tags').appendChild(span);
      this.value = '';
    } else {
      alert('NCM deve ter exatamente 8 dígitos');
    }
  }
});

document.getElementById('has_natureza_fora').addEventListener('change', function(){
  document.getElementById('natureza_fora').style.display = this.value === 'Sim' ? 'block' : 'none';
});

document.getElementById('formFiscal').addEventListener('submit', function(e){
  e.preventDefault();
  const { jsPDF } = window.jspdf;
  const logoImg = document.getElementById('logopdf');  // Pegando a imagem da logo
  const logoSrc = logoImg.src; // Caminho da imagem, que será convertido para base64

  function gen(doc, lines, title){
    let y = 20;
    const pageWidth = doc.internal.pageSize.getWidth();

    // Logo no topo
    if (logoSrc) {
      doc.addImage(logoSrc, 'PNG', (pageWidth - 80) / 2, 10, 50, 20); // Adicionando a imagem da logo
      y = 35;  // Atualizando a posição Y para o conteúdo após a logo
    }

    // Título centralizado
    doc.setFontSize(14);
    doc.setTextColor(40);
    doc.text(title, pageWidth / 2, y, { align: 'center' });
    y += 10;

    // Formatação em tabela
    const rows = lines.map(l => [l.split(':')[0], l.split(':').slice(1).join(':').trim()]);
    doc.autoTable({
      startY: y + 5,
      head: [['Campo', 'Valor']],
      body: rows,
      theme: 'grid',
      styles: { fontSize: 10 },
      headStyles: { fillColor: [0, 0, 0], textColor: 255 },
      alternateRowStyles: { fillColor: [240, 240, 240] }
    });
  }

  // Variáveis para as respostas de "Sim" ou "Não"
  const hasExceptionsNCM = document.getElementById('has_exceptions_ncm').value;
  const hasNaturezaFora = document.getElementById('has_natureza_fora').value;

  // Intra-Estado - Sempre gerado
  const intra = [
    'Natureza de Operação dentro do Estado',
    `CSOSN: ${csosn.value}`, `CFOP: ${cfop.value}`, `ICMS DIFAL: ${icms_difal.value}`,
    `CST IPI: ${cst_ipi.value}`, `Alíquota IPI: ${aliquota_ipi.value}%`,
    `CST ISSQN: ${cst_issqn.options[cst_issqn.selectedIndex].text}`, `Alíquota ISSQN: ${aliquota_issqn.value}%`,
    `Base ISSQN: ${base_issqn.value}%`, `Descontar ISS: ${descontar_iss.value}`,
    `CST PIS: ${cst_pis.value}`, `Base PIS: ${base_pis.value}%`,
    `CST COFINS: ${cst_cofins.value}`, `Base COFINS: ${base_cofins.value}%`,
    `Alíquota COFINS: ${aliquota.value}%`
  ];
  const doc1 = new jsPDF(); 
  gen(doc1, intra, 'Configuração Fiscal - Dentro do Estado');
  doc1.save('Config. Natureza de Operação - Dentro do Estado.pdf');

  // Condicional para verificar se "Exceções de NCM" é "Sim" e se NCM foi inserido
  if (hasExceptionsNCM === 'Sim') {
    const ncmTags = document.querySelectorAll('#ncm_tags .tag');
    if (ncmTags.length === 0) {
      alert('Por favor, adicione pelo menos um NCM para continuar!');
      return; // Impede a geração do PDF de exceções caso não haja NCMs
    }
    
    const exc = [
      'Natureza para NCM’s Exceções',
      `CSOSN: ${csosn_exc.value}`,
      `CFOP: ${cfop_exc.value}`,
      `ICMS DIFAL: ${icms_difal_exc.value}`,
      `CST IPI: ${cst_ipi_exc.value}`,
      `Alíquota IPI: ${aliquota_ipi_exc.value}%`,
      `CST ISSQN: ${cst_issqn_exc.value}`,
      `Alíquota ISSQN: ${aliquota_issqn_exc.value}%`,
      `Base ISSQN: ${base_issqn_exc.value}%`,
      `Descontar ISS: ${descontar_iss_exc.value}`,
      `CST PIS: ${cst_pis_exc.value}`,
      `Base PIS: ${base_pis_exc.value}%`,
      `CST COFINS: ${cst_cofins_exc.value}`,
      `Base COFINS: ${base_cofins_exc.value}%`,
      `Alíquota: ${aliquota_exc.value}%`
    ];

    document.querySelectorAll('#ncm_tags .tag').forEach(t => {
      exc.push(`NCM: ${t.textContent}`);
    });

    const doc3 = new jsPDF();
    gen(doc3, exc, 'Configuração Fiscal - Exceções de NCM');
    doc3.save('Config. Natureza de Operação - Exceções de NCM´s.pdf');
  }

  if (hasNaturezaFora === 'Sim' && hasExceptionsNCM === 'Não') {
    // Se "Fora do Estado" for "Sim" e "Exceções de NCM" for "Não", gera os PDFs de "Dentro do Estado" e "Fora do Estado"
    const fora = [
      'Natureza Fora-Estado',
      `CSOSN: ${csosn_fora.value}`, `CFOP: ${cfop_fora.value}`, `ICMS DIFAL: ${icms_difal_fora.value}`,
      `CST IPI: ${cst_ipi_fora.value}`, `Alíquota IPI: ${aliquota_ipi_fora.value}%`,
      `CST ISSQN: ${cst_issqn_fora.options[cst_issqn_fora.selectedIndex].text}`,
      `Alíquota ISSQN: ${aliquota_issqn_fora.value}%`, `Base ISSQN: ${base_issqn_fora.value}%`,
      `Descontar ISS: ${descontar_iss_fora.value}`, `CST PIS: ${cst_pis_fora.value}`, `Base PIS: ${base_pis_fora.value}%`,
      `CST COFINS: ${cst_cofins_fora.value}`, `Base COFINS: ${base_cofins_fora.value}%`,
      `Alíquota COFINS: ${aliquota_fora.value}%`
    ];
    const doc2 = new jsPDF(); 
    gen(doc2, fora, 'Configuração Fiscal - Fora do Estado');
    doc2.save('Config. Natureza de Operação - Fora do Estado.pdf');
  }

  if (hasExceptionsNCM === 'Sim' && hasNaturezaFora === 'Sim') {
    // Se ambos forem "Sim", gera todos os PDFs
    const exc = [
      'Natureza para NCM’s Exceções',
      `CSOSN: ${csosn_exc.value}`,
      `CFOP: ${cfop_exc.value}`,
      `ICMS DIFAL: ${icms_difal_exc.value}`,
      `CST IPI: ${cst_ipi_exc.value}`,
      `Alíquota IPI: ${aliquota_ipi_exc.value}%`,
      `CST ISSQN: ${cst_issqn_exc.value}`,
      `Alíquota ISSQN: ${aliquota_issqn_exc.value}%`,
      `Base ISSQN: ${base_issqn_exc.value}%`,
      `Descontar ISS: ${descontar_iss_exc.value}`,
      `CST PIS: ${cst_pis_exc.value}`,
      `Base PIS: ${base_pis_exc.value}%`,
      `CST COFINS: ${cst_cofins_exc.value}`,
      `Base COFINS: ${base_cofins_exc.value}%`,
      `Alíquota: ${aliquota_exc.value}%`
    ];

    document.querySelectorAll('#ncm_tags .tag').forEach(t => {
      exc.push(`NCM: ${t.textContent}`);
    });

    const doc3 = new jsPDF();
    gen(doc3, exc, 'Configuração Fiscal - Exceções de NCM');
    doc3.save('Config. Natureza de Operação - Exceções de NCM´s.pdf');

    const fora = [
      'Natureza Fora-Estado',
      `CSOSN: ${csosn_fora.value}`, `CFOP: ${cfop_fora.value}`, `ICMS DIFAL: ${icms_difal_fora.value}`,
      `CST IPI: ${cst_ipi_fora.value}`, `Alíquota IPI: ${aliquota_ipi_fora.value}%`,
      `CST ISSQN: ${cst_issqn_fora.options[cst_issqn_fora.selectedIndex].text}`,
      `Alíquota ISSQN: ${aliquota_issqn_fora.value}%`, `Base ISSQN: ${base_issqn_fora.value}%`,
      `Descontar ISS: ${descontar_iss_fora.value}`, `CST PIS: ${cst_pis_fora.value}`, `Base PIS: ${base_pis_fora.value}%`,
      `CST COFINS: ${cst_cofins_fora.value}`, `Base COFINS: ${base_cofins_fora.value}%`,
      `Alíquota COFINS: ${aliquota_fora.value}%`
    ];
    const doc2 = new jsPDF(); 
    gen(doc2, fora, 'Configuração Fiscal - Fora do Estado');
    doc2.save('Config. Natureza de Operação - Fora do Estado.pdf');
  }
});


  </script>
  

  <div class="footer">
    <p>&copy; 2025 T.HUB - Todos os direitos reservados</p>
  </div>
</body>
</html>
